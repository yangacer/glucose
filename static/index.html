<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glucose Monitoring Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/chart.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Glucose Monitoring Dashboard</h1>
        </header>
        
        <nav class="tabs">
            <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
            <button class="tab-btn" data-tab="glucose">Glucose</button>
            <button class="tab-btn" data-tab="insulin">Insulin</button>
            <button class="tab-btn" data-tab="intake">Intake</button>
            <button class="tab-btn" data-tab="supplements">Supplements</button>
            <button class="tab-btn" data-tab="event">Event</button>
            <button class="tab-btn" data-tab="nutrition">Nutrition</button>
        </nav>
        
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <section class="chart-section">
                <h2>Glucose & Insulin Level Chart</h2>
                <div class="date-filter">
                    <label>Start Date: <input type="date" id="chart-start-date"></label>
                    <label>End Date: <input type="date" id="chart-end-date"></label>
                    <button onclick="loadGlucoseChart()">Update Chart</button>
                </div>
                <canvas id="glucoseChart"></canvas>
            </section>
            
            <section class="summary-section">
                <h2>Summary Timesheet</h2>
                <div class="date-filter">
                    <label>Start Date: <input type="date" id="summary-start-date"></label>
                    <label>End Date: <input type="date" id="summary-end-date"></label>
                    <button onclick="loadSummary()">Update Summary</button>
                </div>
                <div class="table-wrapper">
                    <table id="summaryTable">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Date</th>
                                <th>Dosage</th>
                                <th>+0</th>
                                <th>+1</th>
                                <th>+2</th>
                                <th>+3</th>
                                <th>+4</th>
                                <th>+5</th>
                                <th>+6</th>
                                <th>+7</th>
                                <th>+8</th>
                                <th>+9</th>
                                <th>+10</th>
                                <th>+11</th>
                                <th>kCal</th>
                            </tr>
                        </thead>
                        <tbody id="summaryBody"></tbody>
                    </table>
                    
                    <!-- Overlay for row details -->
                    <div id="summaryOverlay" class="overlay" style="display: none;">
                        <div class="overlay-content">
                            <h3>Details</h3>
                            <div class="overlay-details">
                                <div class="detail-row">
                                    <span class="detail-label">Dose Time:</span>
                                    <span id="overlay-dose-time" class="detail-value">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Intake Time:</span>
                                    <span id="overlay-intake-time" class="detail-value">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Nutritions:</span>
                                    <span id="overlay-nutritions" class="detail-value">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Supplements:</span>
                                    <span id="overlay-supplements" class="detail-value">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Events:</span>
                                    <span id="overlay-events" class="detail-value">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="nutrition-list-section">
                <h2>Nutrition List</h2>
                <div class="table-wrapper">
                    <table id="nutritionListTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nutrition Name</th>
                                <th>kCal</th>
                                <th>Weight (g)</th>
                                <th>kCal per gram</th>
                            </tr>
                        </thead>
                        <tbody id="nutritionListBody"></tbody>
                    </table>
                </div>
            </section>
        </div>
        
        <!-- Glucose Input Tab -->
        <div id="glucose" class="tab-content">
            <h2>Glucose Input</h2>
            <form id="glucoseForm">
                <label>Timestamp: <input type="datetime-local" name="timestamp" id="glucose-timestamp" required> <button type="button" onclick="resetToNow('glucose-timestamp')">Reset to Now</button></label>
                <label>Glucose Level (mg/dL): <input type="number" name="level" required min="0"></label>
                <button type="submit">Submit</button>
            </form>
            <div id="glucose-message" class="message"></div>
            
            <h3>Recent Entries (Last 24 Hours)</h3>
            <div class="audit-filters">
                <label>Start Date: <input type="date" id="glucose-start-filter"></label>
                <label>End Date: <input type="date" id="glucose-end-filter"></label>
                <button onclick="loadGlucoseAudit()">Filter</button>
            </div>
            <div class="table-wrapper">
                <table class="audit-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Timestamp</th>
                            <th>Level (mg/dL)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="glucose-audit-body"></tbody>
                </table>
            </div>
        </div>
        
        <!-- Insulin Input Tab -->
        <div id="insulin" class="tab-content">
            <h2>Insulin Input</h2>
            <form id="insulinForm">
                <label>Timestamp: <input type="datetime-local" name="timestamp" id="insulin-timestamp" required> <button type="button" onclick="resetToNow('insulin-timestamp')">Reset to Now</button></label>
                <label>Insulin Level: <input type="number" name="level" required min="0" step="0.1"></label>
                <button type="submit">Submit</button>
            </form>
            <div id="insulin-message" class="message"></div>
            
            <h3>Recent Entries (Last 24 Hours)</h3>
            <div class="audit-filters">
                <label>Start Date: <input type="date" id="insulin-start-filter"></label>
                <label>End Date: <input type="date" id="insulin-end-filter"></label>
                <button onclick="loadInsulinAudit()">Filter</button>
            </div>
            <div class="table-wrapper">
                <table class="audit-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Timestamp</th>
                            <th>Level</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="insulin-audit-body"></tbody>
                </table>
            </div>
        </div>
        
        <!-- Intake Input Tab -->
        <div id="intake" class="tab-content">
            <h2>Intake Input</h2>
            <form id="intakeForm">
                <label>Timestamp: <input type="datetime-local" name="timestamp" id="intake-timestamp" required> <button type="button" onclick="resetToNow('intake-timestamp')">Reset to Now</button></label>
                
                <h3>Nutrition Items</h3>
                <div id="nutrition-items-container">
                    <div class="nutrition-item">
                        <h4>Nutrition Item 1</h4>
                        <label>Nutrition: 
                            <select name="nutrition_id[]" class="nutrition-select" required>
                                <option value="">Select nutrition...</option>
                            </select>
                        </label>
                        <label>Amount (gram): <input type="number" name="nutrition_amount[]" required min="0" step="0.1"></label>
                        <button type="button" class="remove-nutrition-btn" style="display:none;">Remove</button>
                    </div>
                </div>
                <button type="button" id="add-nutrition-btn" class="secondary-btn">Add Another Nutrition Item</button>
                
                <h3>Supplement Items</h3>
                <div id="supplement-items-container">
                    <div class="supplement-item nutrition-item">
                        <h4>Supplement Item 1</h4>
                        <label>Supplement: 
                            <select name="supplement_id[]" class="supplement-select" required>
                                <option value="">Select supplement...</option>
                            </select>
                        </label>
                        <label>Amount: <input type="number" name="supplement_amount[]" required min="0" step="0.1"></label>
                        <button type="button" class="remove-supplement-btn" style="display:none;">Remove</button>
                    </div>
                </div>
                <button type="button" id="add-supplement-btn" class="secondary-btn">Add Another Supplement</button>
                
                <button type="submit">Submit All</button>
            </form>
            <div id="intake-message" class="message"></div>
            
            <h3>Nutrition - Recent Entries (Last 24 Hours)</h3>
            <div class="audit-filters">
                <label>Start Date: <input type="date" id="intake-start-filter"></label>
                <label>End Date: <input type="date" id="intake-end-filter"></label>
                <button onclick="loadIntakeAudit()">Filter</button>
            </div>
            <div class="table-wrapper">
                <table class="audit-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Timestamp</th>
                            <th>Nutrition</th>
                            <th>Amount (g)</th>
                            <th>kCal</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="intake-audit-body"></tbody>
                </table>
            </div>
            
            <h3>Supplements - Recent Entries (Last 24 Hours)</h3>
            <div class="audit-filters">
                <label>Start Date: <input type="date" id="supplement-intake-start-filter"></label>
                <label>End Date: <input type="date" id="supplement-intake-end-filter"></label>
                <button onclick="loadSupplementIntakeAudit()">Filter</button>
            </div>
            <div class="table-wrapper">
                <table class="audit-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Timestamp</th>
                            <th>Supplement</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="supplement-intake-audit-body"></tbody>
                </table>
            </div>
        </div>
        
        <!-- Supplements Input Tab -->
        <div id="supplements" class="tab-content">
            <h2>Supplements Master</h2>
            <form id="supplementsForm">
                <label>Supplement Name: <input type="text" name="supplement_name" required></label>
                <label>Default Amount: <input type="number" name="default_amount" required min="0" step="0.1" value="1"></label>
                <button type="submit">Submit</button>
            </form>
            <div id="supplements-message" class="message"></div>
            
            <h3>Supplements List</h3>
            <div id="supplements-list"></div>
        </div>
        
        <!-- Event Input Tab -->
        <div id="event" class="tab-content">
            <h2>Event Input</h2>
            <form id="eventForm">
                <label>Timestamp: <input type="datetime-local" name="timestamp" id="event-timestamp" required> <button type="button" onclick="resetToNow('event-timestamp')">Reset to Now</button></label>
                <label>Event Name: <input type="text" name="event_name" required></label>
                <label>Event Notes: <textarea name="event_notes"></textarea></label>
                <button type="submit">Submit</button>
            </form>
            <div id="event-message" class="message"></div>
            
            <h3>Recent Entries (Last 24 Hours)</h3>
            <div class="audit-filters">
                <label>Start Date: <input type="date" id="event-start-filter"></label>
                <label>End Date: <input type="date" id="event-end-filter"></label>
                <button onclick="loadEventAudit()">Filter</button>
            </div>
            <div class="table-wrapper">
                <table class="audit-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Timestamp</th>
                            <th>Event Name</th>
                            <th>Event Notes</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="event-audit-body"></tbody>
                </table>
            </div>
        </div>
        
        <!-- Nutrition Input Tab -->
        <div id="nutrition" class="tab-content">
            <h2>Nutrition Input</h2>
            <form id="nutritionForm">
                <label>Nutrition Name: <input type="text" name="nutrition_name" required></label>
                <label>kCal: <input type="number" name="kcal" required min="0" step="0.01"></label>
                <label>Weight (gram): <input type="number" name="weight" required min="0" step="0.01"></label>
                <button type="submit">Submit</button>
            </form>
            <div id="nutrition-message" class="message"></div>
            
            <h3>Recent Entries</h3>
            <div class="table-wrapper">
                <table class="audit-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nutrition Name</th>
                            <th>kCal</th>
                            <th>Weight (g)</th>
                            <th>kCal per gram</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="nutrition-audit-body"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- JavaScript modules -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/tabs.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/data-loader.js"></script>
    <script src="js/dynamic-items.js"></script>
    <script src="js/forms.js"></script>
    <script src="js/audit.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
